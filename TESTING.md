# 테스트 문서

## 테스트 인프라 개요

이 프로젝트는 최신 React 테스트 전략을 따라 구축되었습니다. **소스코드 수정 없이** 현재 동작을 정확히 테스트하는 원칙을 따릅니다.

## 테스트 아키텍처

```
src/
├── test-utils/
│   ├── test-utils.tsx     # 공통 테스트 유틸리티
│   └── __mocks__/         # MSW 핸들러 (향후 확장용)
├── App.test.js            # 기존 테스트 (호환성 유지)
├── App.enhanced.test.tsx   # 향상된 단위/통합 테스트
├── App.integration.test.tsx # 통합 테스트 중심
└── setupTests.js          # Jest 설정
```

## 테스트 전략 및 비율

### 테스트 트로피 모델 적용
- **정적 분석** (TypeScript, ESLint): 15%
- **단위 테스트**: 25%
- **통합 테스트**: 45% (가장 중요) ⭐
- **E2E 테스트**: 10%
- **시각적 회귀 테스트**: 5%

### 현재 테스트 현황
- **총 테스트 수**: 34개
- **코드 커버리지**: 100%
- **테스트 파일**: 3개
- **테스트 패턴**: AAA (Arrange-Act-Assert) + Given-When-Then

## 테스트 파일별 상세

### 1. App.test.js (기존 테스트)
**목적**: 기존 테스트와의 호환성 유지
- 6개 테스트
- 기본 렌더링 및 버튼 클릭 검증
- 기존 스타일 유지

### 2. App.enhanced.test.tsx (향상된 테스트)
**목적**: 현재 동작의 정확한 문서화 및 상세 검증
- 15개 테스트
- Given-When-Then 패턴 적용
- 한국어 description 사용
- 모든 UI 요소와 동작의 세밀한 검증

**주요 테스트 그룹**:
- 기본 렌더링 검증 (2개)
- 기능 리스트 표시 동작 (2개)
- 테스트 버튼 인터랙션 (3개)
- 버전 정보 표시 (3개)
- 통합 테스트 - 전체 앱 동작 (3개)
- 에러 처리 및 엣지 케이스 (2개)

### 3. App.integration.test.tsx (통합 테스트 중심)
**목적**: 사용자 시나리오 기반 통합 테스트 (45% 비중)
- 13개 테스트
- 실제 사용자 워크플로우 시뮬레이션
- 접근성 및 성능 테스트 포함
- 향후 확장성 검증

**주요 테스트 그룹**:
- 사용자 시나리오 기반 통합 테스트 (2개)
- 컴포넌트 간 상호작용 테스트 (2개)
- 환경별 동작 테스트 (2개)
- 접근성 및 사용성 통합 테스트 (2개)
- 성능 및 렌더링 최적화 테스트 (2개)
- 브라우저 호환성 시뮬레이션 테스트 (1개)
- 향후 확장성을 위한 아키텍처 테스트 (2개)

## 테스트 유틸리티

### test-utils.tsx
커스텀 렌더링 및 테스트 헬퍼 함수 제공:

```typescript
// 사용자 이벤트와 함께 렌더링
const { user } = renderWithUserEvents(<Component />);
await user.click(button);

// 환경 변수 모킹
const restore = testUtils.mockEnv({ NODE_ENV: 'test' });

// Alert 모킹
testUtils.mockAlert();
```

## 현재 동작 문서화 원칙

### ✅ 정확한 현재 동작 테스트
- 버튼 클릭 시 `alert('Jenkins CI/CD 테스트 성공!')` 호출
- 하드코딩된 버전 정보 `'버전: 1.0.0'` 표시
- 환경 변수 `process.env.NODE_ENV` 그대로 표시
- 4개 기능 항목의 정확한 텍스트 검증

### ⚠️ 발견된 특이사항 문서화
- `NODE_ENV`가 undefined일 때 빈 문자열로 표시
- React.StrictMode에서 정상 동작
- 연속 버튼 클릭에 대한 일관된 응답

## 테스트 명명 규칙

### Describe 블록
- `"[컴포넌트명] 컴포넌트"`
- `"[기능명] 동작"`
- `"[시나리오명] 테스트"`

### It 블록 (한국어)
- **현재 동작 문서화**: `"현재 구현된 [동작]을 테스트한다"`
- **긍정적 시나리오**: `"[조건]에서 [동작]하면 [결과]해야 한다"`
- **부정적 시나리오**: `"[잘못된 조건]에서 [동작]하면 [예상 결과]해야 한다"`

## 커버리지 목표 및 현황

### 목표
- **전체 코드 커버리지**: 80% 이상 ✅ (현재 100%)
- **핵심 비즈니스 로직**: 95% 이상 ✅ (현재 100%)
- **공통 컴포넌트**: 90% 이상 ✅ (현재 100%)

### 현재 달성도
```
----------|---------|----------|---------|---------|
File      | % Stmts | % Branch | % Funcs | % Lines |
----------|---------|----------|---------|---------|
All files |     100 |      100 |     100 |     100 |
 App.js   |     100 |      100 |     100 |     100 |
----------|---------|----------|---------|---------|
```

## 테스트 실행 명령어

```bash
# 모든 테스트 실행 (커버리지 포함)
npm test

# 특정 파일 테스트
npm test -- --testPathPattern="App.enhanced.test.tsx"

# 커버리지 리포트 생성
npm test -- --coverage

# CI 환경용 테스트
npm run test:ci
```

## 향후 확장 계획

### MSW (Mock Service Worker) 설정
- API 호출이 추가될 때 활성화 예정
- 핸들러 파일 이미 준비됨: `src/test-utils/__mocks__/handlers.ts`

### 상태 관리 테스트
- Zustand나 Context API 도입 시 테스트 확장
- Provider 래핑 구조 이미 준비됨

### E2E 테스트
- Playwright 도입 고려 중
- 현재 통합 테스트로 대부분 커버됨

## 모범 사례

### 1. 현재 동작 우선
```typescript
// ✅ 좋은 예
it('현재 구현된 alert 동작을 테스트한다', () => {
  // Given: 현재 구현된 상태
  // When: 현재 동작 실행
  // Then: 현재 결과 검증
});

// ❌ 나쁜 예 
it('이상적인 동작을 테스트한다', () => {
  // 현재 구현과 다른 이상적인 동작 테스트
});
```

### 2. 사용자 중심 테스트
```typescript
// ✅ 좋은 예
expect(screen.getByRole('button')).toBeInTheDocument();

// ❌ 나쁜 예
expect(wrapper.find('.test-button')).toHaveLength(1);
```

### 3. 통합 테스트 우선
```typescript
// ✅ 좋은 예: 전체 사용자 플로우
it('사용자가 앱을 처음 방문했을 때의 전체 경험을 테스트한다', () => {
  // 1. 제목 확인
  // 2. 기능 리스트 확인  
  // 3. 버튼 클릭
  // 4. 결과 확인
});
```

## 문제 해결

### 일반적인 이슈
1. **테스트 실패 시**: 현재 구현 동작 재확인
2. **새 기능 추가 시**: 기존 테스트 영향도 확인
3. **리팩토링 시**: 외부 동작 변경 없이 진행

### 디버깅 팁
```typescript
// 현재 렌더링된 DOM 확인
screen.debug();

// 특정 요소의 textContent 확인
console.log(element.textContent);

// 모든 역할 확인
screen.logTestingPlaygroundURL();
```

이 테스트 인프라는 현재 동작을 정확히 문서화하고, 향후 확장에 대비한 견고한 기반을 제공합니다.